<!DOCTYPE html>
<html>
	<head>
		<title>JS Example - Select data with a spatial condition</title>
		<script src="http://code.jquery.com/jquery-1.7.1.min.js" type="text/javascript"></script>
		<script src="../../../lib/gftlib-js/GftLib.js" type="text/javascript"></script>
		<script src="../../../lib/gftlib-js/SqlBuilder.js" type="text/javascript"></script>
		<script type="text/javascript">
			function init() {
				var tableId = 3133838;
				var gft = new GftLib();
				var sqlBuilder = new SqlBuilder();
				var resultList = document.getElementById("result");
				
				var printer = function(data) {
					var objs = gft.convertToObject(data);
					
					for (var i = 0; i < objs.length; i++) {
						
						var listElem = document.createElement('li');
						listElem.innerHTML = 'name: ' + objs[i].name;
						resultList.appendChild(listElem);
					}
				}
				
				var sqlQuery = sqlBuilder.select('*', tableId, 'ST_INTERSECTS(geometry, CIRCLE(LATLNG(47.555,8.5),5000))');
				document.getElementById('query').innerHTML = sqlQuery;
				document.getElementById('source').innerHTML = 'Data from Google Fusion Table (ID: ' + tableId + ')';
				gft.execSql(printer, sqlQuery);
			}
		</script>
	</head>
	<body onload="init();">
		<h1>JS Example - Select data with a spatial condition</h1>
		<h2>Query</h2>
		<div id="query"></div>
		<h2>Source</h2>
		<div id="source"></div>
		<h2>Result</h2>
		<ul id="result"></ul>
	</body>
</html>